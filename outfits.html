 <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>outfit maker</title>
  <style>
    body {
      font-family: Georgia, serif;
      font-size: 16px;
      letter-spacing: 1.2px;
      background-color: #FFCCCB;
      color: #452c00;
      font-weight: 700;
      text-transform: uppercase;
    }
    .container1 {
	  margin: 0 auto;
	  margin-top: 10px;
      text-align: center;
      background-color: #362200;
      padding: 10px;
      border-radius: 30px;
      width: 900px;
      min-height: 90%;
      
    }
    .container {
	  margin: 0 auto;
	  margin-top: 10px;
      text-align: center;
      background-color: #F8E9D0;
      padding: 30px;
      border-radius: 30px;
      width: 90%;
      
    }

    h1 {
      margin-bottom: 20px;
      color: #FFCCCB;
    }
    
    img {
    transform: scale(0.5);
  } 
    select {
      font-family: Impact, serif;
      font-size: 10px;
      color: #362200;
      background-color: #F8E9D0;
      text-transform: none;
      border: none;
    }

    select:hover {
      background-color: #362200;
      color: #F8E9D0;
      border-radius: 5px;
    }


	a:hover {
	  color: #FFFFFF; /* Change text color to white */
	  transform: scale(1.05); /* Add a slight zoom effect */
	}
	
	a:active {
	  transform: scale(0.95); /* Add a "pressed" effect */
	}
    .image-gallery {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      margin-bottom: 20px;
    }

    .image-gallery img {
      width: 100px;
      height: 100px;
      object-fit: cover;
      margin: 10px;
      cursor: pointer;
      border-radius: 5px;
      transition: transform 0.3s ease;
    }

    .image-gallery img:hover {
      transform: scale(1);
    }
    .image-gallery img {
      transform: scale(0.75);
    }
    
    .preview-box {
      position: absolute;
      top: 10px;
      left: 10px;
      width: 300px;
      height: 300px;
      border: 2px dashed #362200;
      background-color: transparent;
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .preview-box img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }
    
    #canvas {
	  margin: 0 auto;
	  margin-top: 10px;
      position: relative;
      width: 90%;
      min-height: 500px;
      border: 2px dashed #362200;
      border-radius: 10px;
      overflow: hidden;
      background: transparent;      
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: auto;

    }

    #canvas p {
      color: #FF9999;
      font-size: 1.2em;
    }

    .draggable {
      position: absolute;
      max-width: 150px;
      max-height: 150px;
      cursor: grab;
      user-select: none;
    }

    .draggable:active {
    position: absolute;
      cursor: grabbing;
    transition: transform 0.2s ease-in-out; /* Smooth zooming */
    }

    /* Hide the gallery by default */
    .hidden {
      display: none;
    }

    button {
      background-color: #4f3100;
      text-transform: uppercase;
      border-radius: 5px;
      border: 1px solid #362200;
      display: inline-block;
      cursor: pointer;
      color: #ffffff;
      font-family: Impact;
      font-size: 10px;
      padding: 6px 3px;
      text-decoration: none;
      margin: 10px
    }
    
    button:hover {
    background-color: #7e4400;
    }
    
    button:active {
    padding: 4px 2px;
    }

    #showTopsButton, #showBottomsButton, #showOtherButton {
      display: inline-block;
      cursor: pointer;
      text-transform: capitalize;
      color: #ffffff;
      font-family: Georgia;
      font-size: 17px;
      font-weight: bold;
      padding: 10px 37px;
      text-decoration: none;
      text-shadow: 3px 3px 0px #528ecc;
      margin: 10px;
      margin-bottom: 10px;
      background-color: #FFCCCB;
      text-shadow: 3px 3px 0px #FF9999;
      box-shadow: 4px 4px 0px 0px #FF9999;
      border: 1px solid #FF9999;
      border-radius: 0px;
    }
    
    #showTopsButton:hover, #showBottomsButton:hover, #showOtherButton:hover {
    	border: none;
    }
    
    #showTopsButton:active, #showBottomsButton:active, #showOtherButton:active {
	  background-color: #FFCCCB;
	  box-shadow: 2px 2px #FF9999;
	  transform: translateY(2px);
	  transform: translateX(2px);
    }
#zoomSlider {
  -webkit-appearance: none;
  width: 20%;
  height: 10px;
  background: #FFCCCB;
  outline: none;
  border-radius: 6px;
  transition: 0.2s;
  cursor: pointer;
  border: 2px solid #FF9999;
}



#zoomSlider::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 20px;
  height: 20px;
  background: #FFCCCB;
  border: 2px solid #FF9999;
  border-radius: 50%;
  cursor: pointer;
  transition: 0.2s;
}

#zoomSlider::-webkit-slider-thumb:hover {
  background: #FF9999;
}

#zoomSlider::-moz-range-thumb {
  width: 18px;
  height: 18px;
  background: #fff;
  border: 2px solid #FF3333;
  border-radius: 50%;
  cursor: pointer;
}

#zoomSlider::-moz-range-thumb:hover {
  background: #FFCCCC;
  border-color: #FF0000;
}

.controls {
  display: flex;
  align-items: center;
  gap: 10px;
  justify-content: center;
  margin: 10px 0;
}
    
  </style>
</head>
<body>
  <div class=container1>
    <a href="index.html" style="
      display: inline-block;
      margin: 15px;
      text-decoration: none;
      color: #FFCCCB;
      font-size: 1rem;
      transition: background-color 0.3s ease;">
      Back to Home
    </a>
    <a href="view-arrangements.html" style="
      display: inline-block;
      margin: 15px;
      text-decoration: none;
      color: #FFCCCB;
      font-size: 1rem;
      transition: background-color 0.3s ease;">
      view saved outfits
    </a>
    <h1>outfit drag-and-drop</h1>

    <!-- Buttons for Tops, Bottoms, and Other categories -->
    <button id="showTopsButton">Tops</button>
    <button id="showBottomsButton">Bottoms</button>
    <button id="showOtherButton">Other</button>

    <!-- Subcategory buttons for Tops -->
    <div id="topsButtons" class="hidden">
      <button data-folder="tubeTops">Tube Tops</button>
      <button data-folder="tankTops">Tank Tops</button>
      <button data-folder="teeShirts">Tee Shirts</button>
      <button data-folder="longSleeves">Long Sleeves</button>
      <button id="viewAllTops">All Tops</button>
    </div>

    <!-- Subcategory buttons for Bottoms -->
    <div id="bottomsButtons" class="hidden">
      <button data-folder="jeans">Jeans</button>
      <button data-folder="skirts">Skirts</button>
      <button data-folder="otherPants">Other Pants</button>
      <button data-folder="shorts">Shorts</button>
      <button id="viewAllBottoms">All Bottoms</button>
    </div>

    <!-- Subcategory buttons for Other -->
    <div id="otherButtons" class="hidden">
      <button data-folder="jackets">Jackets</button>
      <button data-folder="shoes">Shoes</button>
    </div>
<div class="container">
    <!-- Displaying image thumbnails -->
    <div class="image-gallery" id="imageGallery">
      <!-- Thumbnails will be dynamically inserted here -->
    </div>
<div>
<div class="controls">
  <label for="zoomSlider">zoom</label>
  <input type="range" id="zoomSlider" min="50" max="200" value="50">
  <button id="togglePreviewButton">preview box</button>
</div>
<div id="canvas" class="canvas">
<div class="preview-container" style="display: none;">
  <div class="preview-box"></div>
</div>
      <p>clothes go here!</p>
    </div>

  </div></div>

  </div>
 <script>
    const imageGallery = document.getElementById('imageGallery');
    const canvas = document.getElementById('canvas');

    // Buttons for Tops, Bottoms, and Other categories
    const showTopsButton = document.getElementById('showTopsButton');
    const showBottomsButton = document.getElementById('showBottomsButton');
    const showOtherButton = document.getElementById('showOtherButton');

    // Subcategory buttons
    const topsButtons = document.getElementById('topsButtons');
    const bottomsButtons = document.getElementById('bottomsButtons');
    const otherButtons = document.getElementById('otherButtons');
    const viewAllTopsButton = document.getElementById('viewAllTops');
    const viewAllBottomsButton = document.getElementById('viewAllBottoms');
    const viewAllOtherButton = document.getElementById('viewAllOther');

    // Folders for each category
    const folders = {
      tops: ['tubeTops', 'tankTops', 'teeShirts', 'longSleeves'],
      bottoms: ['jeans', 'skirts', 'otherPants', 'shorts'],
      other: ['jackets', 'shoes']
    };

     // Function to display the images as thumbnails
    function displayThumbnails(folderNames) {
      imageGallery.innerHTML = ''; // Clear the gallery

      folderNames.forEach(folder => {
        for (let i = 1; i <= 100; i++) {
          const imgElement = document.createElement('img');
          const imgSrc = `images/${folder}/${i}.png`;

          // Create a new image to check if the photo exists
          const img = new Image();
          img.src = imgSrc;

          img.onload = function() {
            // If image is loaded successfully, add it to the gallery
            imgElement.src = imgSrc;
            imgElement.alt = `${folder} ${i}`;
            imgElement.onclick = () => addImageToCanvas(imgSrc);

            imageGallery.appendChild(imgElement);
          };

          img.onerror = function() {
            // If the image can't be loaded, break the loop for this folder
            console.log(`No ${i}.png found in ${folder}. Stopping further attempts.`);
            return;  // Break the loop by returning early
          };
        }
      });
    }

    function addImageToCanvas(imageSrc) {
      const imgContainer = createPhotoContainer(imageSrc);
      canvas.appendChild(imgContainer);
    }

    // Create photo container with drag functionality
    function createPhotoContainer(photoSrc) {
      const container = document.createElement('div');
      container.classList.add('draggable-container');

      // Set random initial position for the container
      container.style.position = 'absolute';
      container.style.left = `${Math.random() * (canvas.offsetWidth - 100)}px`;
      container.style.top = `${Math.random() * (canvas.offsetHeight - 100)}px`;

      // Create the image
      const img = document.createElement('img');
      img.src = photoSrc;
      img.classList.add('draggable');

      // Disable default drag behavior to avoid copying
      img.setAttribute('draggable', 'false');

      // Add drag-and-drop functionality
      container.addEventListener('mousedown', onDragStart);
      //prevent scroll on touch
      container.addEventListener('touchstart', onDragStart);

      // Double-click to delete photo
      container.addEventListener('dblclick', () => {
        container.remove();
      });

      // Append the image to the container
      container.appendChild(img);

      return container;
    }

const togglePreviewButton = document.getElementById('togglePreviewButton');
const previewContainer = document.querySelector('.preview-container');

togglePreviewButton.addEventListener('click', () => {
  if (previewContainer.style.display === 'none') {
    previewContainer.style.display = 'block';
    togglePreviewButton.textContent = "Hide Preview";
  } else {
    previewContainer.style.display = 'none';
    togglePreviewButton.textContent = "Show Preview";
  }
});



    // Drag-and-drop logic
    let draggedElement = null;

    function onDragStart(event) {
       event.preventDefault(); //prevent scroll while dragging on touch devices
      const container = event.currentTarget; // Target the container, not the image
      draggedElement = container;

      // Get the offset between the mouse and the container
        let offsetX, offsetY;
        if (event.type === 'touchstart') {
            const touch = event.touches[0];
            const rect = container.getBoundingClientRect();
           offsetX = touch.clientX - rect.left;
            offsetY = touch.clientY - rect.top;
        } else {
            const rect = container.getBoundingClientRect();
            offsetX = event.clientX - rect.left;
            offsetY = event.clientY - rect.top;
        }
    


      // Move the element as the mouse moves
      function onMouseMove(e) {
        e.preventDefault(); // prevent scroll while dragging
        const canvasRect = canvas.getBoundingClientRect();
          let x, y;
          if (e.type === 'touchmove') {
            const touch = e.touches[0];
             x = touch.clientX - canvasRect.left - offsetX;
            y = touch.clientY - canvasRect.top - offsetY;
          } else {
               x = e.clientX - canvasRect.left - offsetX;
               y = e.clientY - canvasRect.top - offsetY;
          }
       

        // Constrain the element within the canvas
        x = Math.max(0, Math.min(x, canvas.offsetWidth - container.offsetWidth));
        y = Math.max(0, Math.min(y, canvas.offsetHeight - container.offsetHeight));

        container.style.left = `${x}px`;
        container.style.top = `${y}px`;
      }

      // Clean up when the mouse is released
      function onMouseUp() {
           document.removeEventListener('mousemove', onMouseMove);
           document.removeEventListener('mouseup', onMouseUp);
            document.removeEventListener('touchmove', onMouseMove);
           document.removeEventListener('touchend', onMouseUp);
      }
        
        if (event.type === 'touchstart') {
            document.addEventListener('touchmove', onMouseMove, { passive: false });
            document.addEventListener('touchend', onMouseUp);

        } else {
              document.addEventListener('mousemove', onMouseMove);
             document.addEventListener('mouseup', onMouseUp);
        }

    }

    // Event listeners for category buttons
    showTopsButton.addEventListener('click', () => {
      topsButtons.classList.toggle('hidden');
      bottomsButtons.classList.add('hidden'); // Hide bottoms buttons if open
      otherButtons.classList.add('hidden'); // Hide other buttons if open
      imageGallery.innerHTML = ''; // Clear gallery when switching
    });

    showBottomsButton.addEventListener('click', () => {
      bottomsButtons.classList.toggle('hidden');
      topsButtons.classList.add('hidden'); // Hide tops buttons if open
      otherButtons.classList.add('hidden'); // Hide other buttons if open
      imageGallery.innerHTML = ''; // Clear gallery when switching
    });

    showOtherButton.addEventListener('click', () => {
      otherButtons.classList.toggle('hidden');
      topsButtons.classList.add('hidden'); // Hide tops buttons if open
      bottomsButtons.classList.add('hidden'); // Hide bottoms buttons if open
      imageGallery.innerHTML = ''; // Clear gallery when switching
    });

    // Event listener for subcategory buttons
    topsButtons.addEventListener('click', (e) => {
      if (e.target.dataset.folder) {
        displayThumbnails([e.target.dataset.folder]);
      }
    });

    bottomsButtons.addEventListener('click', (e) => {
      if (e.target.dataset.folder) {
        displayThumbnails([e.target.dataset.folder]);
      }
    });

    otherButtons.addEventListener('click', (e) => {
      if (e.target.dataset.folder) {
        displayThumbnails([e.target.dataset.folder]);
      }
    });

    // View all tops
    viewAllTopsButton.addEventListener('click', () => {
      displayThumbnails(folders.tops);
    });

    // View all bottoms
    viewAllBottomsButton.addEventListener('click', () => {
      displayThumbnails(folders.bottoms);
    });
    
  const saveDatabaseButton = document.createElement('button');
  saveDatabaseButton.textContent = "Save Outfit";
  saveDatabaseButton.style.margin = "10px";
  document.querySelector('.container').appendChild(saveDatabaseButton);

  const loadDatabaseButton = document.createElement('button');
  loadDatabaseButton.textContent = "Load Outfit";
  loadDatabaseButton.style.margin = "10px";
  document.querySelector('.container').appendChild(loadDatabaseButton);

  const databaseSelect = document.createElement('select');
  databaseSelect.style.margin = "10px";
  document.querySelector('.container').appendChild(databaseSelect);

  // Initialize the database in localStorage
  if (!localStorage.getItem('photoArrangementsDB')) {
    localStorage.setItem('photoArrangementsDB', JSON.stringify({}));
  }

  // Populate the dropdown with saved arrangements
  function updateDatabaseDropdown() {
    const database = JSON.parse(localStorage.getItem('photoArrangementsDB'));
    databaseSelect.innerHTML = '<option value="">pick outfit</option>';
    Object.keys(database).forEach((key) => {
      const option = document.createElement('option');
      option.value = key;
      option.textContent = key;
      databaseSelect.appendChild(option);
    });
  }

  updateDatabaseDropdown();

saveDatabaseButton.addEventListener('click', () => {
  const name = prompt("Enter a name for this arrangement:");
  if (!name) return alert("Arrangement name is required!");

  // Retrieve the database from localStorage, or initialize it as an empty object if it's null
  let database = JSON.parse(localStorage.getItem('photoArrangementsDB'));
  if (!database) {
    database = {}; // Initialize an empty object if database doesn't exist
  }

  // Check if the name already exists in the database
  if (database[name]) {
    const overwrite = confirm(`An arrangement named "${name}" already exists. Do you want to overwrite it?`);
    if (!overwrite) return; // Exit if the user chooses not to overwrite
  }

  // Collect additional metadata
  const timestamp = new Date().toISOString();

  // Collect photo data (ensure it's in array format)
  const photos = Array.from(canvas.querySelectorAll('.draggable-container'));
  const arrangement = photos.map(photo => {
    const img = photo.querySelector('img');
    return {
      src: img.src,
      left: photo.style.left,
      top: photo.style.top,
    };
  });

  // Save the arrangement along with metadata (ensure it's stored as an array of objects)
  database[name] = {
    arrangement, // This is an array of photo objects
    timestamp,   // Timestamp when the arrangement was saved
  };

  // Save the updated database back to localStorage
  console.log(arrangement);
  localStorage.setItem('photoArrangementsDB', JSON.stringify(database));
  updateDatabaseDropdown();

  alert(`Arrangement "${name}" saved successfully!`);
});




  // Load arrangement from database
loadDatabaseButton.addEventListener('click', () => {
  const selectedArrangement = databaseSelect.value;
  if (!selectedArrangement) return alert("Please select an arrangement to load!");

  const database = JSON.parse(localStorage.getItem('photoArrangementsDB'));
  const entry = database[selectedArrangement];

  // Display metadata (optional)
  console.log(`Loading arrangement: ${selectedArrangement}`);
  console.log(`Saved on: ${entry.timestamp || "Unknown date"}`);

  // Clear the canvas and load the arrangement
  canvas.innerHTML = '<p>clothes go here!</p>';
  entry.arrangement.forEach(item => {
    const imgContainer = createPhotoContainer(item.src);
    imgContainer.style.left = item.left;
    imgContainer.style.top = item.top;
    canvas.appendChild(imgContainer);
  });
});

const zoomSlider = document.getElementById('zoomSlider');

zoomSlider.addEventListener('input', () => {
    const scaleValue = zoomSlider.value / 100;
    document.querySelectorAll('#canvas .draggable-container img').forEach(img => {
        img.style.transform = `scale(${scaleValue})`;
    });
});

  </script>
</script>
</body>
</html>
